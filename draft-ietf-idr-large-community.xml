<?xml version="1.0" encoding="US-ASCII"?>
<!DOCTYPE rfc SYSTEM "rfc2629.dtd">
<?rfc toc="yes"?>
<?rfc tocompact="yes"?>
<?rfc tocdepth="3"?>
<?rfc tocindent="yes"?>
<?rfc symrefs="yes"?>
<?rfc sortrefs="yes"?>
<?rfc comments="yes"?>
<?rfc inline="yes"?>
<?rfc compact="yes"?>
<?rfc subcompact="no"?>
<rfc category="std" docName="draft-ietf-idr-large-community-01" ipr="trust200902">
  <front>
    <title abbrev="Large BGP Communities">Large BGP Communities</title>

    <author fullname="Jakob Heitz" initials="J." surname="Heitz">
        <organization>Cisco</organization>
        <address>
            <postal>
                <street>170 West Tasman Drive</street>
                <city>San Jose</city>
                <region>CA</region>
                <code>95054</code>
                <country>USA</country>
            </postal>
            <email>jheitz@cisco.com</email>
        </address>
    </author>

    <author fullname="Keyur Patel" initials="K." surname="Patel">
        <organization abbrev="Arrcus">Arrcus, Inc</organization>
        <address>
            <email>keyur@arrcus.com</email>
        </address>
    </author>

    <author fullname="Job Snijders" initials="J." surname="Snijders">
        <organization abbrev="NTT">NTT Communications</organization>
        <address>
            <postal>
                <street>Theodorus Majofskistraat 100</street>
                <code>1065 SZ</code>
                <city>Amsterdam</city>
                <country>NL</country>
            </postal>
            <email>job@ntt.net</email>
        </address>
    </author>

    <author fullname="Ignas Bagdonas" initials="I." surname="Bagdonas">
        <organization>Equinix</organization>
        <address>
            <postal>
                <street></street>
                <city>London</city>
                <country>UK</country>
            </postal>
            <email>ibagdona.ietf@gmail.com</email>
        </address>
    </author>

    <author fullname="Adam Simpson" initials="A." surname="Simpson">
        <organization>Nokia</organization>
        <address>
            <postal>
                <street>600 March Road</street>
                <city>Ottawa</city>
                <code>Ontario K2K 2E6</code>
                <country>Canada</country>
            </postal>
            <email>adam.1.simpson@nokia.com</email>
        </address>
    </author>

    <date/>

    <area>Routing</area>
    <workgroup>IDR</workgroup>
    <keyword>BGP</keyword>
    <keyword>communities</keyword>

    <abstract>
        <t>
            The BGP Communities Attribute <xref target="RFC1997"/> is heavily
            used by operators, but is inadequate to represent large enough
            values, particularly Four-octet Autonomous System numbers
	    <xref target="RFC6793"/> plus additional values.
            This document describes an extension to BGP <xref target="RFC4271"/>
            to address this need with a new extended form of the BGP Communities
	    Attribute.
        </t>
    </abstract>

    <note title="Requirements Language">
        <t>
            The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
            "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in
            this document are to be interpreted as described in
            <xref target="RFC2119"/>.
        </t>
    </note>

  </front>

  <middle>
      <section title="Introduction">
          <t>
              BGP implementations typically support a routing policy
              language to control the distribution of routing information.
              Network operators attach BGP communities to routes according
              to their routing policy to identify intrinsic properties of
              these routes.  These properties may include information such
              as the route origin location, or specification of a routing
              policy action to be taken, or one that has been taken, and may
              apply to an individual route or group of routes.  Because BGP
              communities are optional transitive BGP attributes, BGP
              communities may be acted upon or otherwise used by routing
              policies in other Autonomous Systems (AS) on the Internet.
          </t>
          <t>
              <xref target="RFC1997"/> BGP Communities Attributes are
              four-octet values split into two separate two-octet words.
              The most significant word is usually interpreted as an
              Autonomous System Number (ASN) and the least significant word
              is a locally defined value whose meaning is assigned by
              the operator of the Autonomous System to which it applies.
          </t>
          <t>
              Since the adoption of four-octet ASNs <xref
              target="RFC6793"/>, the BGP Communities Attribute can no
              longer accommodate this encoding, as the specification in
              <xref target="RFC1997"/> contains only four octets.  This does
              not allow operators to specify any locally significant values.
              <!-- NOTE: need to mention Extended Communities here  -->
          </t>
          <t>
              To address these shortcomings, this document defines a Large
              Community BGP Attribute to encode one or more 12-octet values,
              each consisting of a four-octet ASN and two four-octet
              operator-defined values, each of which can be used to denote
              properties or actions significant to that ASN.
          </t>
    </section>

    <section title="Large BGP Communities Attribute">
        <t>
            This document creates the Large Communities BGP path attribute
            as an optional transitive attribute of variable length.  All
            routes with the Large Communities attribute belong to the
            community specified in the attribute.
        </t>
        <t>
            The Large Communities attribute has Type Code [TBD - RFC EDITOR
            to fill-in IANA assigned value].
        </t>
        <t>
            The attribute consists of one or more 12-octet values. Each
            12-octet Large Communities value represents three 4-octet values, as
            follows:
<figure align="center"><artwork><![CDATA[
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                 ASN                           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                         Local Data Part 1                     |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                         Local Data Part 2                     |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
]]></artwork></figure></t>

<t>
    <list style="hanging">
        <t hangText="ASN:">The Four-octet Autonomous System Number of the operator with whom definition of the final two 4-octet values lies.</t>
        <t hangText="Local Data Part 1:">4-octet operator-defined value.</t>
        <t hangText="Local Data Part 2:">4-octet operator-defined value.</t>
    </list>
</t>
        <t>
It is not a protocol error to put an invalid ASN into the ASN field.
For example 0 or 23456 are allowed. It is up to the receiving BGP speaker to
recognize (or not) any received large communities. There are no routing semantics
implied by the ASN field. For example, this document does not require a receiver
of a Large Communities attribute  to know where the AS identified by the ASN of a Large Communities attribute is and
to forward the route containing that large community towards that AS.
The ASN field is simply a convenience that allows different ASes to define large communities
without clashing with each other. If an AS wants to use invalid ASNs in the ASN
field privately within its own AS or even by agreement with a neighboring AS, then
this document does not prohibit it.
        </t>
        <t>
The large communities are transmitted in the order: ASN, followed by part 1, followed by part 2.
Each integer is in network byte order.
That is, most significant bit first. The first Large Communities attribute immediately follows the BGP
path attribute header. Each Large Communities attribute immediately follows the previous one. There is no
significance to the order in which the large communities are transmitted. Duplicate
large communities SHOULD NOT be transmitted. A receiving speaker MAY silently remove
duplicate large communities and MAY retransmit them in an order different to which
it received them.
        </t>

    </section>

    <section title="Aggregation">
        <t>
   If a range of routes is to be aggregated and the resultant aggregates
   attribute section does not carry the ATOMIC_AGGREGATE attribute, then
   the resulting aggregate should have a large communities path attribute
   which contains all large communities from all of the aggregated routes.
        </t>

    </section>

    <section title="Textual Representation">
        <t>
            The textual representation of BGP Communities <xref target="RFC1997"/>
            in routing policy languages and the networking community is known
            well as two 2-octet unsigned integers and is often represented as
            such, separated by a colon. For example, 65000:12345
            (ASN:differentia).
        </t>
        <t>
            Large Communities MUST be represented similarly, as three 4-octet
            unsigned decimal integers with no leading zeros. An integer MUST NOT be
            omitted, even when zero. Implementations MUST represent Large
            Communities in a manner consistent with their representation
            of BGP Communities <xref target="RFC1997"/>. For example, 65000:1:2
            (ASN:Local Data Part 1:Local Data Part 2) or 65000:0:0.
        </t>
        <t>
The following Large BGP Communities textual specification uses the Augmented
Backus-Naur Form (ABNF) notation as specified in <xref target="RFC5234"/>.
<figure align="center">
<artwork><![CDATA[
        positive-digit  = "1" / "2" / "3" /
                          "4" / "5" / "6" /
                          "7" / "8" / "9"

        digit           = "0" / positive-digit

        non-zero-int    = positive-digit *9digit

        part            = "0" / non-zero-int ; max value is
                          4294967295

        large-community = part ":" part ":" part
]]></artwork>
</figure>
</t>
        <t>
            Vendors MAY provide other textual representations. For example,
            some vendor's routing policy language may use a separator other
            than a colon or may require keywords or characters prepending or
            postpending the Large Communities attribute. Such differences are permitted.
            However, each implementation MUST make a representation available
            that depicts the intergers in decimal and in the order (ASN:Local
            Data Part 1:Local Data Part 2).
        </t>

    </section>

    <section title="Error Handling">
        <t>
            The error handling of Large Communities is as follows:
        </t>
        <t>
            <list style="symbols">
                <t>
                    A Large Communities BGP Path Attribute with a length of zero
                    MUST be ignored upon receipt and removed when sending.
                </t>
                <t>
                    A Large Communities attribute SHALL be considered malformed
                    if its length is not a non-zero multiple of 12 bytes.
                </t>
                <t>
                    A BGP UPDATE message with a malformed Large Communities
                    attribute SHALL be handled using the approach of
		    "treat-as-withdraw" as described in
		    <xref target="RFC7606">section 2</xref>.
                </t>
            </list>
        </t>
    </section>

    <section title="Security Considerations">
        <t>
            This extension to BGP has similar security implications as BGP
            Communities <xref target="RFC1997"/>.
        </t>
        <t>
            underlying security issues. Specifically, an AS relying on the
	    BGP attributes carried in BGP must have trust in every AS in the
	    path to the source of the route, as any AS in the path may have
	    altered or deleted attributes or added false attributes.
            Specifying the mechanism(s) to provide such trust is beyond the
	    scope of this document.
        </t>
   </section>
   
   <section title="Implementation status - RFC EDITOR: REMOVE BEFORE PUBLICATION">
       <t>
           This section records the status of known implementations of the
           protocol defined by this specification at the time of posting of
           this Internet-Draft, and is based on a proposal described in
           <xref target="RFC7942" />. The description of implementations in this
           section is intended to assist the IETF in its decision processes in
           progressing drafts to RFCs.  Please note that the listing of any
           individual implementation here does not imply endorsement by the
           IETF.  Furthermore, no effort has been spent to verify the
           information presented here that was supplied by IETF contributors.
           This is not intended as, and must not be construed to be, a catalog
           of available implementations or their features.  Readers are advised
           to note that other implementations may exist.
       </t>
       <t>
           As of today these vendors have produced an implementation of Large
           BGP Community:
           <list style="symbols">
               <t>Cisco IOS XR</t>
               <t>ExaBGP</t>
               <t>GoBGP</t>
            </list>
       </t>
       <t>
           The latest implementation news is tracked at
           <eref target="https://largebgpcommunities.net">http://largebgpcommunities.net/</eref>.
       </t>
   </section>

    <section title="IANA Considerations">
        <t>
            IANA is requested to assign a BGP path attribute value for the
            Large Communities attribute.
        </t>
    </section>

    <section title="Acknowledgements">
        <t>
            The authors would like to thank Ruediger Volk, Russ White, Acee
            Lindem, Shyam Sethuram, Jared Mauch, Joel M. Halpern, Nick
            Hilliard, Jeffrey Haas, John Heasley, Gunter van de Velde, Marco
            Marzetti, Eduardo Ascenco Reis, Mark Schouten, Paul Hoogsteder,
            Martijn Schmidt, Greg Hankins, Acee Lindem, Bertrand Duvivier,
            Barry O'Donovan, Grzegorz Janoszka, Linda Dunbar, Marco Davids,
            Gaurab Raj Upadhaya, Jeff Tantsura, Teun Vink, Adam Davenport,
            Theodore Baschak, Pier Carlo Chiodi, Nabeel Cocker, Ian Dickinson,
            Jan Baggen, Duncan Lockwood, David Farmer, Randy Bush, Wim
            Henderickx, Stefan Plug, Kay Rechthien, Rob Shakir, Warren Kumari,
            Gert Doering, Thomas King, Mikael Abrahamsson, Wesley Steehouwer,
            Sander Steffann, Brad Dreisbach, Martin Millnert, Christopher
            Morrow, Jay Borkenhagen, Arnold Nipper, Joe Provo, Niels Bakker,
            Bill Fenner, Tom Daly, Ben Maddison, Alexander Azimov, Brian
            Dickson and Peter van Dijk for their support, insightful review and
            comments.
        </t>
    </section>

  </middle>

  <back>
    <references title="Normative References">
      <?rfc include="reference.RFC.1997"?>
      <?rfc include="reference.RFC.2119"?>
      <?rfc include="reference.RFC.4271"?>
      <?rfc include="reference.RFC.6793"?>
      <?rfc include="reference.RFC.7606"?>
    </references>
    <references title="Informative References">
      <?rfc include="reference.RFC.5234"?>
      <?rfc include="reference.RFC.7942"?>
    </references>


  </back>
</rfc>
